<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>node | 留简</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="//yun.duiba.com.cn/aurora/assets/28757dfc494a84649d1b9e9e9daa3a57420d00cd.jpeg">script,[object Object]
    <meta name="description" content="Just Text">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.a872a4b8.js" as="script"><link rel="preload" href="/assets/js/2.15df7a88.js" as="script"><link rel="preload" href="/assets/js/21.fabc5358.js" as="script"><link rel="prefetch" href="/assets/js/10.f8078958.js"><link rel="prefetch" href="/assets/js/11.2fb20a5f.js"><link rel="prefetch" href="/assets/js/12.54d40458.js"><link rel="prefetch" href="/assets/js/13.16d28edc.js"><link rel="prefetch" href="/assets/js/14.2072c223.js"><link rel="prefetch" href="/assets/js/15.644c409f.js"><link rel="prefetch" href="/assets/js/16.dd8186f9.js"><link rel="prefetch" href="/assets/js/17.9cd1efad.js"><link rel="prefetch" href="/assets/js/18.a6d8459b.js"><link rel="prefetch" href="/assets/js/19.4fee1775.js"><link rel="prefetch" href="/assets/js/20.37e9681c.js"><link rel="prefetch" href="/assets/js/22.362e31cd.js"><link rel="prefetch" href="/assets/js/23.6aeb1ade.js"><link rel="prefetch" href="/assets/js/24.fc456d4d.js"><link rel="prefetch" href="/assets/js/25.5755a3b5.js"><link rel="prefetch" href="/assets/js/26.fb388ce5.js"><link rel="prefetch" href="/assets/js/3.01fc8ecb.js"><link rel="prefetch" href="/assets/js/4.cdd7d74c.js"><link rel="prefetch" href="/assets/js/5.c5db995c.js"><link rel="prefetch" href="/assets/js/6.7e410269.js"><link rel="prefetch" href="/assets/js/7.dac9ffbf.js"><link rel="prefetch" href="/assets/js/8.1dcffe2c.js"><link rel="prefetch" href="/assets/js/9.74af2c56.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="//yun.duiba.com.cn/aurora/assets/28757dfc494a84649d1b9e9e9daa3a57420d00cd.jpeg" alt="留简" class="logo"> <span class="site-name can-hide">留简</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  HOME
</a></div><div class="nav-item"><a href="/Note/" class="nav-link router-link-active">
  NOTE
</a></div><div class="nav-item"><a href="/DEMO/" class="nav-link">
  DEMO
</a></div><div class="nav-item"><a href="https://github.com/secret821/liuyan.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  git
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://weibo.com/u/7346009584" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  HOME
</a></div><div class="nav-item"><a href="/Note/" class="nav-link router-link-active">
  NOTE
</a></div><div class="nav-item"><a href="/DEMO/" class="nav-link">
  DEMO
</a></div><div class="nav-item"><a href="https://github.com/secret821/liuyan.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  git
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://weibo.com/u/7346009584" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Note/HTML.html" class="sidebar-link">HTML</a></li><li><a href="/Note/CSS.html" class="sidebar-link">css</a></li><li><a href="/Note/node.html" aria-current="page" class="active sidebar-link">node</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Note/node.html#_1-es6" class="sidebar-link">1.ES6</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Note/node.html#_1-块级作用域" class="sidebar-link">（1）块级作用域</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_1-node-js是运行在服务器端的js解释器-基于谷歌的v8引擎" class="sidebar-link">1.Node.js是运行在服务器端的js解释器，基于谷歌的v8引擎</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_2-全局对象" class="sidebar-link">2.全局对象</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_3-定时器" class="sidebar-link">3.定时器</a></li></ul></li><li class="sidebar-sub-header"><a href="/Note/node.html#day11" class="sidebar-link">day11</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Note/node.html#_1-模块" class="sidebar-link">1.模块</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_2-模块分类" class="sidebar-link">2.模块分类</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_3-包和npm" class="sidebar-link">3.包和npm</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_4-querystring模块" class="sidebar-link">4.querystring模块</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_5-url模块" class="sidebar-link">5.URL模块</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_6-timer定时器模块" class="sidebar-link">6.timer定时器模块</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_7-文件系统模块-fs" class="sidebar-link">7.文件系统模块（fs）</a></li></ul></li><li class="sidebar-sub-header"><a href="/Note/node.html#day12" class="sidebar-link">day12</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Note/node.html#_1-同步和异步" class="sidebar-link">1.同步和异步</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_2-文件系统模块" class="sidebar-link">2.文件系统模块</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_3-http协议" class="sidebar-link">3.http协议</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_4-http模块" class="sidebar-link">4.http模块</a></li></ul></li><li class="sidebar-sub-header"><a href="/Note/node.html#day13" class="sidebar-link">day13</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Note/node.html#_1-框架" class="sidebar-link">1.框架</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_1-路由" class="sidebar-link">（1）路由</a></li></ul></li><li class="sidebar-sub-header"><a href="/Note/node.html#day14" class="sidebar-link">day14</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Note/node.html#_1-路由器" class="sidebar-link">1.路由器</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_2-中间件" class="sidebar-link">2.中间件</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_3-mysql模块" class="sidebar-link">3.mysql模块</a></li></ul></li><li class="sidebar-sub-header"><a href="/Note/node.html#day15" class="sidebar-link">day15</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Note/node.html#_1-mysql模块" class="sidebar-link">1.mysql模块</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_2-正则表达式" class="sidebar-link">2.正则表达式</a></li><li class="sidebar-sub-header"><a href="/Note/node.html#_3-restful接口-api" class="sidebar-link">3.RESTful接口（API）</a></li></ul></li><li class="sidebar-sub-header"><a href="/Note/node.html#day16" class="sidebar-link">day16</a></li></ul></li><li><a href="/Note/数据库.html" class="sidebar-link">数据库5.8</a></li><li><a href="/Note/js.html" class="sidebar-link">js</a></li><li><a href="/Note/jscode.html" class="sidebar-link">jscode</a></li><li><a href="/Note/VUEUI.html" class="sidebar-link">VUEUI</a></li><li><a href="/Note/react.html" class="sidebar-link">React 学习笔记 📒</a></li><li><a href="/Note/微信小程序.html" class="sidebar-link">微信小程序</a></li><li><a href="/Note/UniApp.html" class="sidebar-link">UniApp</a></li><li><a href="/Note/game.html" class="sidebar-link">game🎮</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="node"><a href="#node" class="header-anchor">#</a> node</h1> <h2 id="_1-es6"><a href="#_1-es6" class="header-anchor">#</a> 1.ES6</h2> <p>ECMA -&gt; ECMAScript -&gt;  ES</p> <p>​               标准规范</p> <p>ES6 js的第六套标准规范</p> <p>课后作业</p> <p>创建函数，传递任意一个日期，返回这一天是一年中的第几天</p> <p>例如  getDays（2021，5，18）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getDay</span><span class="token punctuation">(</span><span class="token parameter">year<span class="token punctuation">,</span>month<span class="token punctuation">,</span>day</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//如果是闰年是29天，否则28天</span>
    <span class="token keyword">var</span> second <span class="token operator">=</span> year<span class="token operator">%</span><span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token operator">&amp;&amp;</span> year<span class="token operator">%</span><span class="token number">100</span> <span class="token operator">!=</span><span class="token number">0</span> <span class="token operator">||</span> year<span class="token operator">%</span><span class="token number">400</span> <span class="token operator">?</span> <span class="token number">29</span> <span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">;</span>
    <span class="token comment">//声明变量，用于记录天数，先把当前月天数加入进去</span>
    <span class="token keyword">var</span> sum <span class="token operator">=</span> day<span class="token punctuation">;</span>
    <span class="token comment">//每个月的天数不同</span>
    <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span>second<span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//遍历当前月份</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> month<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        sum <span class="token operator">+=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//返回总的天数</span>
    <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getDay</span><span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getDays</span><span class="token punctuation">(</span><span class="token parameter">year<span class="token punctuation">,</span>month<span class="token punctuation">,</span>date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//计算当前日期距离一年的一月一日相差的毫秒数</span>
    <span class="token keyword">var</span> d1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span>month<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>date<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> d2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> d <span class="token operator">=</span> d1 <span class="token operator">-</span> d2<span class="token punctuation">;</span>
    <span class="token comment">//相差的值换算为天</span>
    <span class="token keyword">return</span> d<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getDays</span><span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_1-块级作用域"><a href="#_1-块级作用域" class="header-anchor">#</a> （1）块级作用域</h3> <p>为了解决全局污染的问题</p> <p>let a = 1；</p> <p>let声明的变量<strong>不存在提升</strong>，在<strong>同一个作用域</strong>下，<strong>不允许重复声明</strong>同一个变量</p> <p>大括号{}之间的语句块就是一个块级作用域，例如：if、else、while、do while、for....在块级作用域下，let和const声明的都是局部的，无法被访问到。</p> <div class="language-test extra-class"><pre class="language-text"><code>var let const三个区别
var 声明的变量存在提升，在同一个作用域下可以重复声明同一个变量
let 声明的变量不存在提升，在同一个作用域下不允许重复声明同一个变量，存在块级作用域，即使在全局作用域下let声明的变量也不是全局的
const 声明的时候必须赋值，不允许重新赋值，存在块级作用域，即使在全局作用域下const声明的常量也不是全局的
</code></pre></div><p>练习：计算1~100之间所有整数的和，要求使用let声明变量</p> <h4 id="_2-参数增强"><a href="#_2-参数增强" class="header-anchor">#</a> （2）参数增强</h4> <p>可以给数的参数设置默认值</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token number">0</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 <span class="token comment">//c = c||0;  //es6之前的默认值设置</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span> <span class="token comment">//没有出现的实参就会使用默认值</span>
</code></pre></div><h4 id="_3-箭头函数"><a href="#_3-箭头函数" class="header-anchor">#</a> （3）箭头函数</h4> <p>()=&gt;{ }</p> <p>作用：简化了匿名函数的写法，不等价于匿名函数</p> <div class="language-js extra-class"><pre class="language-js"><code>arr<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a<span class="token operator">-</span>b<span class="token punctuation">;</span><span class="token comment">//从小到大的排序</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//如果箭头函数里的函数体中只有一行函数，并且为return形式</span>
arr<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>a<span class="token operator">-</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//从小到大的排序</span>
</code></pre></div><p>练习：使用函数表达式创建函数（用匿名函数）将之前的匿名函数使用箭头函数代替，计算任意三个数字的平均值并返回结果。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token operator">+</span>c<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>
</code></pre></div><p>（4）模板字符串</p> <p>解决了字符串的拼接问题</p> <p>、模板字符串 ${JS表达式}</p> <p>练习：声明变量保存一条员工的数据，格式为对象，包含的属性有编号，姓名，性别（1/0），工资；最后打印出以下格式</p> <p>编号：X</p> <p>姓名：XX</p> <p>性别：男／女</p> <p>工资：XXXX.00元</p> <h3 id="_1-node-js是运行在服务器端的js解释器-基于谷歌的v8引擎"><a href="#_1-node-js是运行在服务器端的js解释器-基于谷歌的v8引擎" class="header-anchor">#</a> 1.Node.js是运行在服务器端的js解释器，基于谷歌的v8引擎</h3> <h4 id="_1-对比js"><a href="#_1-对比js" class="header-anchor">#</a> （1）对比JS</h4> <p>JS运行在客户端浏览器，存在多种JS解释器，存在代码兼容性问题；</p> <p>Node.js只有V8引擎一种解释器，不存在代码兼容性问题</p> <p>JS和Node.js都有共同的ES（内置）对象和自定义对象，不同的宿主对象</p> <p>JS用于开发浏览器端的交互效果，Node.js用于服务器端开发，例如数据库的访问，其他服务器的调用.....</p> <h4 id="_2-网址"><a href="#_2-网址" class="header-anchor">#</a> （2）网址</h4> <p>www.nodejs.org  官网</p> <p>www.nodejs.cn    中文镜像</p> <h4 id="_3-使用node-js"><a href="#_3-使用node-js" class="header-anchor">#</a> （3）使用node.js</h4> <p>脚本模式</p> <p>node  拖拽脚本文件   回车</p> <p>node 文件名前几个数字+tab键</p> <p>交互模式</p> <p>进入：node  回车  进入交互模式</p> <p>退出：两次CTRL+C      或者    一次CTRL+D</p> <h4 id="_4-特点"><a href="#_4-特点" class="header-anchor">#</a> （4）特点</h4> <p>Node.js属于<strong>单线程运行逻辑</strong>，支持数万个并发连接，适合做<strong>基于社交网络的大规模web应用</strong>，不适合做CPU密集型的操作。</p> <h3 id="_2-全局对象"><a href="#_2-全局对象" class="header-anchor">#</a> 2.全局对象</h3> <p>也叫全局模块</p> <p>（1）global</p> <p>检测一个变量或者函数是否为全局的</p> <p>交互模式属于全局作用域，创建的函数和声明的变量是全局的</p> <p>每个脚本文件都是在一个作用域下，里边的函数和变量都是局部的，不存在全局污染</p> <p>JS下的global叫做window</p> <p>练习：编写脚本文件03_global.js,在脚本文件下声明变量、创建函数，然后通过global检测是否为全局</p> <p>练习：创建文件04_window.js和04.html，把js嵌入html，声明变量、创建函数，然后通过window检测是否为全局</p> <p>（2）console</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//日志</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//消息</span>
console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//警告</span>
console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//错误</span>
开始计时和结束计时的参数要保持一致
console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开始计时</span>
console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//结束计时</span>
</code></pre></div><p>练习：分别查看for、while、do—while三种循环分别循环100000次的耗时</p> <p>（3）process</p> <p>进程：计算机上的软件运行都是代表相应的进程</p> <p>API</p> <p>process.arch   :查看当前CPU的架构</p> <p>process.platform :查看当前的操作系统</p> <p>process.version :查看当前Node.js的版本号</p> <p>process.pid：查看当前node的进程编号</p> <p>process.kill（进程编号）：结束指定编号的进程</p> <p>（4）buffer</p> <p>缓冲器：在内存中临时存储数据的区域，常用于保存网络传输时的资源</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> buf <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'好的'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置大小为6个字节  一个汉字占三个字节</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//底层是二进制编码，显示的是16进制的编码</span>
<span class="token comment">//将buffer转为字符串</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将Buffer数据转为字符串</span>
</code></pre></div><h3 id="_3-定时器"><a href="#_3-定时器" class="header-anchor">#</a> 3.定时器</h3> <p>一次性定时器：</p> <p>开启：</p> <p>var timer = setTimeout(回调函数，间隔时间)</p> <p>当间隔时间到了，调用一次回调函数</p> <p>清除：</p> <p>cleanTimeOut（timer）</p> <p><img src="C:%5CUsers%5CASUS%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210519194441220.png" alt="image-20210519194441220"></p> <p>主程序（执行）</p> <p>定时器（回调函数，时间（ms））</p> <p>回调函数在事件队列里执行</p> <p>定时器的执行：</p> <p>主程序执行时回调函数放入事件队列（由一组回调函数组成）等待时间过后执行回调函数</p> <p>课后任务</p> <p>(1)复习今天内容，整理思维导图</p> <p>(2)练习</p> <p>创建主模块(main.js)和功能模块(circle.js)，在功能模块下导出两个函数，传递参数半径，分别返回周长和面积；在主模块下引入成功后，调用这两个函数</p> <p>(3)预习nodejs第2天内容，异步</p> <h2 id="day11"><a href="#day11" class="header-anchor">#</a> day11</h2> <h3 id="_1-模块"><a href="#_1-模块" class="header-anchor">#</a> 1.模块</h3> <p>是一个独立的功能体，模块可以被其他的模块引入，也可以引入其他的模块</p> <p>require（） 用于引入其他的模块,得到导出的对象</p> <p>module.exports  当前模块导出的对象，是一个空对象，用于存放导出的内容</p> <p>__dirname  当前模块的绝对目录</p> <p>__filename  当前模块的绝对目录+模块名称</p> <h3 id="_2-模块分类"><a href="#_2-模块分类" class="header-anchor">#</a> 2.模块分类</h3> <p>分为自定义模块、第三方模块、核心模块</p> <table><thead><tr><th></th> <th>以路径开头</th> <th>不以路径开头</th></tr></thead> <tbody><tr><td>文件形式</td> <td><strong>require（./circle.js‘）</strong>                     用于引入自定义模块</td> <td>**require('querystring')**引入官方提供的核心模块</td></tr> <tr><td>目录形式</td> <td>**require(./02_tao)**首先会在目录下寻找package.json文件中main属性对应的文件，如果找不到会自动找index.js</td> <td>**require('tao')**会到同一级的node_modules目录中寻找tao目录，如果找不到会一直往上一级的node_modules        （用于引入第三方模块）</td></tr></tbody></table> <p>json文件中属性名和属性值要用双引号，且不能添加注释</p> <p>练习：在03_1.js中引入同一级的目录模块03_2,目录下含有文件index.js,导出一个函数，传递任意两个数字返回最大值，最后在03_1.js中调用该函数</p> <h3 id="_3-包和npm"><a href="#_3-包和npm" class="header-anchor">#</a> 3.包和npm</h3> <p>包（package）：指的是第三方模块</p> <p>CommonJS规范：Node.js就是遵循这个规范，出现的模块概念。JS之所以作为服务器端语言，就是遵循这个规范。</p> <p>下载地址：www.npmjs.com</p> <p>（1）切换命令行的目录</p> <p>1.<strong>cd  粘贴目录的路径</strong>     回车</p> <p>如果有盘符的变化，需要添加  <strong>盘符名称</strong>：回车</p> <p>2.window10：</p> <p>在要进入的目录下的空白区域，按住shift+单击右键，选择 ‘在此处打开powershell窗口’</p> <p>（2）使用npm</p> <p>在Node.js安装的时候会附带安装</p> <p><strong>npm -v</strong>  查看版本号</p> <p><strong>npm init -y</strong>  初始化一个package.json文件，是项目描述文件，可以记录下安装的包</p> <p><strong>npm install 包的名称</strong>    下载安装包,将包放入到node_modules中，如果没有node_modules，会自动创建，把安装包放进去，同时会生成package-lock.json文件，记录所有包的版本号；在pageage.json中会记录安装的这个包的信息。</p> <p><strong>npm install</strong>       自动去安装package.json和package-lock.json中记录的包,生成node_modules</p> <p><strong>npx</strong> /nvm ：切换node的版本</p> <p>npx -p node@版本号 node -v</p> <p>npx -p node@版本号 node 文件路径             下载指定版本的node.js，然后运行文件，运行完会将下载的nodejs删除</p> <h3 id="_4-querystring模块"><a href="#_4-querystring模块" class="header-anchor">#</a> 4.querystring模块</h3> <p>查询字符串：浏览器向服务器发请求传递数据的一种方式，位于浏览器的地址栏（URL），以问号（？）为分割</p> <p><a href="https://search.jd.com/Search" target="_blank" rel="noopener noreferrer">https://search.jd.com/Search<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>?<strong>keyword=电脑&amp;enc=utf-8</strong></p> <p>查询字符串模块用于操作查询字符串的工具模块</p> <p>浏览器-&gt;web服务器-&gt;数据库-&gt;转递给服务器</p> <p>parse（）   将查询字符串解析为对象</p> <p>练习：获取以下查询字符串中传递的数据</p> <p>‘lid=5&amp;num=1'</p> <h3 id="_5-url模块"><a href="#_5-url模块" class="header-anchor">#</a> 5.URL模块</h3> <p>URL：统一资源定位，互联网上的任何资源都有对应的URL</p> <p>http://<strong>www.codeboy.com</strong>:<strong>9999</strong>/product_details.html?lid=5</p> <p>协议        域名/IP地址              端口   文件在服务器的路径   查询字符串</p> <p>URL模块用于操作URL的工具模块</p> <p>parse（）  解析一个URL为对象，可以获取URL中的各个部分</p> <p>练习：获取以下URL中传递的查询字符串数据</p> <p><a href="https://www.tmooc.cn:443/web/course.html?cid=2104&amp;cname=nodejs" target="_blank" rel="noopener noreferrer">https://www.tmooc.cn:443/web/course.html?cid=2104&amp;cname=nodejs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>打印出   班级编号：2104   课程名称：nodejs</p> <h3 id="_6-timer定时器模块"><a href="#_6-timer定时器模块" class="header-anchor">#</a> 6.timer定时器模块</h3> <p>定时器模块，提供一组全局函数</p> <p>（1）一次性定时器</p> <p>见day01笔记</p> <p>（2）周期性定时器</p> <p>开启</p> <p>let timer = setInterval（回调函数，间隔时间）</p> <p>每隔一段时间，调用一次回调函数</p> <p>清除：</p> <p>cleanInterval（timer）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 练习：使用周期性定时器每隔两秒钟打印hello，打印3次后结束</span>
<span class="token comment">//声明变量用于记录次数</span>
<span class="token comment">// let count = 0;</span>
<span class="token comment">// let timer = setInterval( () =&gt;{</span>
<span class="token comment">//     console.log('hello');</span>
<span class="token comment">//     //每打印一次，记录一次</span>
<span class="token comment">//     count++;</span>
<span class="token comment">//     //判断是否为3</span>
<span class="token comment">//     if(count === 3){</span>
<span class="token comment">//         cleanInterval(timer);</span>
<span class="token comment">//     }</span>
<span class="token comment">// },2000);</span>
</code></pre></div><p>练习：使用周期性定时器每隔两秒钟打印hello，打印3次后结束</p> <p>（3）立即执行定时器</p> <table><thead><tr><th>开启：let timer = setImmediate(回调函数)      清除：cleanImmediate（timer）</th></tr></thead> <tbody><tr><td>开启：process.nextTick(回调函数)</td></tr></tbody></table> <p>setImmediate在事件队列的最前边，process.nextTick在主程序的后边，时间队列的前边</p> <p><img src="C:%5CUsers%5CASUS%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210520200054564.png" alt="image-20210520200054564"></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//立即执行定时器</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setImmediate</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_7-文件系统模块-fs"><a href="#_7-文件系统模块-fs" class="header-anchor">#</a> 7.文件系统模块（fs）</h3> <p>服务器端的文件包含目录形式和文件形式</p> <p>fs.statSync(文件路径)  查看文件的状态</p> <p>​ isDirecotry()是否为文件</p> <p>fs.mkdirSync(目录的路径)   创建目录</p> <p>fs.rmdirSync(目录的路径)   删除目录</p> <p>课后任务</p> <p>(1)复习今天内容，整理思维导图</p> <p>(2)练习：开启一次性定时器，3秒以后创建1~10,10个目录；15秒以后再把这10个目录删除。</p> <p>(3)预习nodejs第3天  同步和异步</p> <h2 id="day12"><a href="#day12" class="header-anchor">#</a> day12</h2> <h3 id="_1-同步和异步"><a href="#_1-同步和异步" class="header-anchor">#</a> 1.同步和异步</h3> <p>同步：在主程序中执行，会阻止后续代码的执行，是通过返回值来获取结果</p> <p>异步：在一个独立的线程执行，不会阻止后续代码额执行，是通过回调函数来获取结果（大文件或复杂文件）</p> <p>异步（多线程）</p> <p>主程序（fs.stat 异步）执行完执行事件队列</p> <p>线程池：一旦有异步任务，会从线程池中获取一个线程执行任务 ，当执行完把结果以回调函数形式放入到事件队列，把线程归还回去</p> <h3 id="_2-文件系统模块"><a href="#_2-文件系统模块" class="header-anchor">#</a> 2.文件系统模块</h3> <p>（1）查看文件状态</p> <p>fs.stat(文件的路径，回调函数)</p> <p>​ 回调函数 用来获取结果</p> <p>​ err   可能产生的错误</p> <p>​ s       成功的结果</p> <p>（2）读取目录</p> <p>readdirSync（目录的路径）/readdir（目录的路径，回调函数）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//读取目录</span>
<span class="token comment">// 同步</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span><span class="token string">'../day11'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//异步</span>
fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">'../day11'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>arr2</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>（3）清空写入</p> <p>writeFileSync（文件的路径，数据）/writeFile（文件的路径，数据，回调函数）</p> <p>如果文件不存在，先创建文件然后写入数据</p> <p>如果文件已经存在，先清空文件中的内容，然后写入数据</p> <div class="language- extra-class"><pre class="language-text"><code>//同步
fs.writeFileSync('./1.txt','涛哥');
// 异步
fs.writeFile('./2.txt','is',(err)=&gt;{
    if(err){
        throw err;
    }
    console.log('写入成功');
})
console.log('运行结束');
</code></pre></div><p>（4）追加写入</p> <p>appendFileSync（文件的路径，数据）/appendFile（文件的路径，数据，回调函数）</p> <p>如果文件不存在，先创建文件然后写入数据</p> <p>如果文件已经存在，会在文件的末尾追加写入数据</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//创建数组，包含有多个姓名，遍历数组得到每个姓名，将每个姓名使用异步方式写入到文件stu.txt中</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'tao'</span><span class="token punctuation">,</span><span class="token string">'li'</span><span class="token punctuation">,</span><span class="token string">'liu'</span><span class="token punctuation">,</span><span class="token string">'tom'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">//    异步  顺序随机无法确定</span>
    <span class="token comment">//arr[i]</span>
    fs<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span><span class="token string">'./stu.txt'</span><span class="token punctuation">,</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>  <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'写入成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//    同步  顺序不变</span>
    fs<span class="token punctuation">.</span><span class="token function">appendFileSync</span><span class="token punctuation">(</span><span class="token string">'./stu2.txt'</span><span class="token punctuation">,</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>（5）读取文件</p> <p>readFileSync(文件的路径)/readFile（文件的路径，回调函数）读取的数据，格式默认为buffer</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//同步读取</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//&lt;Buffer e6 b6 9b e5 93 a5&gt;  格式为Buffer</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//把Buffer转为字符串</span>
<span class="token comment">//异步读取1.txt</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./1.txt'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data1</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>  <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'运行结束'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>（6）删除文件</p> <p>unlinkSync（文件的路径）/unlink（文件的路径，回调函数）</p> <div class="language-node extra-class"><pre class="language-text"><code>// 同步
fs.unlinkSync('./1.txt');
//异步
fs.unlink('./2.txt',(err,data1)=&gt;{
    if(err)  throw err;
})
</code></pre></div><p>（7）检测文件是否存在</p> <p>exitsSync（文件的路径）</p> <p>存在-&gt;true    不存在-&gt;false</p> <p>练习：如果文件3.txt存在，同步删除该文件；如果目录mydir不存在，则同步创建该目录。</p> <p>（8）拷贝文件</p> <p>copyFileSync（源文件路径，目标文件路径）/copyFile(源文件路径，目标文件路径，回调函数)</p> <p>（9）流</p> <p>读取的文件流（源文件）</p> <p>写入的文件流（目标文件）</p> <p>流：一段一段</p> <p>createReadStream()  创建可读取的文件流</p> <p>createWriteStream()  创建可写入的文件流</p> <p>pipe（）  管道，可以将读取流通过管道添加到写入流</p> <p>on（事件名称，回调函数）添加事件，一旦事件触发，会调用回调函数；事件名称是字符串格式</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//添加事件，监听是否有数据流入内存</span>
<span class="token comment">//on(参数1,参数2)  添加事件</span>
<span class="token comment">//参数1：是一个字符串，表示事件的名称，是固定的</span>
<span class="token comment">//data  数据流入</span>
<span class="token comment">//参数2：是一个回调函数，一旦触发事件，调用这个函数，</span>
<span class="token comment">// 在回调函数中获取流入的数据</span>
<span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//统计数量</span>
rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
<span class="token comment">//    chunk:获取的分段数据</span>
<span class="token comment">//     console.log(chunk);</span>
    count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//流入一次加1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//添加事件：读取结束事件</span>
<span class="token comment">// 一旦读取结束，调用回调函数</span>
rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> rs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'./node.zip'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建可写入的文件流,创建空文件</span>
<span class="token keyword">let</span> ws <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'./2.zip'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//将读取的文件流 通过管道 添加到可写入的文件流</span>
rs<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ws<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-http协议"><a href="#_3-http协议" class="header-anchor">#</a> 3.http协议</h3> <p>浏览器和WEB服务器之间的通信协议</p> <p><a href="http://www.codeboy.com:9999/index.html" target="_blank" rel="noopener noreferrer">http://www.codeboy.com:9999/index.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="C:%5CUsers%5CASUS%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210521154645814.png" alt="image-20210521154645814"></p> <h4 id="_1-通用头信息-general"><a href="#_1-通用头信息-general" class="header-anchor">#</a> （1）通用头信息（General）</h4> <p><strong>Request URL</strong>：请求的URL，表示要请求的服务器端资源</p> <p><strong>Request Method</strong>：请求的方式，对资源的操作方式     GET：服务器端获取资源      POST：传递数据给服务器</p> <p><strong>Status Code</strong>：响应的状态码</p> <p>1**：服务器端接收到了请求，还没做出响应</p> <p>2**：成功的响应</p> <p>3**：响应的重定向，跳转到另一个URL</p> <p>4**（404）：客户端请求错误</p> <p>5**：服务器端错误</p> <h4 id="_2-响应头信息-response"><a href="#_2-响应头信息-response" class="header-anchor">#</a> （2）响应头信息（response）</h4> <p>Content-Type：设置响应的内容类型</p> <p>解决中文乱码：text/html;charset=utf-8</p> <p>Location：设置响应的重定向中要跳转的URL（结合3**）</p> <h4 id="_3-请求头信息-request"><a href="#_3-请求头信息-request" class="header-anchor">#</a> （3）请求头信息（request）</h4> <h4 id="_4-请求主体"><a href="#_4-请求主体" class="header-anchor">#</a> （4）请求主体</h4> <p>可有可无，如果有数据传递才会出现</p> <h3 id="_4-http模块"><a href="#_4-http模块" class="header-anchor">#</a> 4.http模块</h3> <p>可以用来创建web服务器，接收请求</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//引入http模块</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建web服务器</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//设置端口</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//通过事件来接受请求并作出响应</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    req 请求的对象
    req<span class="token punctuation">.</span>url  获取请求的<span class="token constant">URL</span>，格式为<span class="token string">'/jianbing'</span> <span class="token string">'/youtiao'</span>
    req<span class="token punctuation">.</span>method  获取请求的方法
    res  响应的对象
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  设置响应的内容
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  设置响应的状态码和头信息
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  结束并发送
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>小图标 favicon.ico</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token comment">//设置响应的状态码和头信息</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
        <span class="token string">'Content-Type'</span><span class="token operator">:</span><span class="token string">'text/html;charset=utf-8'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-node extra-class"><pre class="language-text"><code>/设置响应到浏览器的内容
// res.write('这是你的jianbing');
// //结束并发送响应
// res.end();
// });
</code></pre></div><div class="language-node extra-class"><pre class="language-text"><code>// 设置响应的状态码为302，设置跳转的URL
res.writeHead(302,{
    Location:'http://www.tmooc.cn/'
});
//结束并发送
res.end();
</code></pre></div><div class="language-node extra-class"><pre class="language-text"><code>//设置状态码为404
res.writeHead(404);
//设置响应的内容
res.write('Not Found');
//结束并发送
res.end();
});
</code></pre></div><p>课后任务
(1)复习今天内容，整理思维导图
(2)练习：创建web服务器，设置端口8080，添加事件，根据请求作出响应</p> <p>if(url==='./')</p> <p>​    '/list'   响应  '这是商品列表'
​    '/index'    响应文件'1.html'，先读取文件，然后把读取的内容作为响应的内容
​    '/study'   跳转到 <a href="http://www.tmoo.cn/" target="_blank" rel="noopener noreferrer">http://www.tmoo.cn<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
​    其它    响应状态码404    not found
(3)预习nodejs第4天</p> <h2 id="day13"><a href="#day13" class="header-anchor">#</a> day13</h2> <h3 id="_1-框架"><a href="#_1-框架" class="header-anchor">#</a> 1.框架</h3> <p>一整套项目解决方法，简化了已有的功能，添加了之前没有的功能。</p> <p>1.express框架</p> <p>基于Node.js平台，快速、开发、极简的web开发框架</p> <p>网址：www.expressjs.com.cn</p> <p>属于第三方的模块，需要先去下载安装</p> <p>npm install <strong>express</strong></p> <table><thead><tr><th>const express = require('express');</th></tr></thead> <tbody><tr><td>const app = express();//创建WEB服务器</td></tr> <tr><td>app.listen(8080);//设置端口</td></tr></tbody></table> <h3 id="_1-路由"><a href="#_1-路由" class="header-anchor">#</a> （1）路由</h3> <p>用来处理不同的请求，根据请求的URL和请求的方法来做出特定的响应。</p> <p>路由的三要素：请求的URL、请求的方法、回调函数</p> <p><em><strong>req请求对象</strong></em></p> <p>req.url                   获取请求的URL</p> <p>req.method          获取请求的方法</p> <p><strong>req.query</strong>              获取查询字符串传递的数据</p> <p><em><strong>res响应对象</strong></em></p> <p>res.send（）        设置响应的内容并发送</p> <p>res.redirect（）   设置响应的重定向并且发送</p> <p>res.sendFile（）   设置响应的文件并发送，文件必须使用绝对路径（__dirname)</p> <p>./XXXX:相对路径</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/person'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
&lt;!--运用模板字符串--&gt;
        &lt;h2&gt;这是个人中心&lt;/h2&gt;
        欢迎回来
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//添加路由：跳转</span>
<span class="token comment">//get  /study</span>
<span class="token comment">//跳转到  tmooc</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/study'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'http://www.codeboy.com:9999/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//添加路由（get  /),跳转到 /person</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">//同一个服务器下,直接写'/URL'</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/person'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//添加路由（get/index），响应文件1.html</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
<span class="token comment">//    响应文件,使用绝对路径</span>
    res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>__dirname<span class="token operator">+</span><span class="token string">'/1.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//路由（post  /  mylogin）</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/mylogin'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">//url后接收不到</span>
    <span class="token comment">//获取post传递的数据，采用流的方式</span>
    <span class="token comment">//需要使用事件的方式获取</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">//得到的数据是buffer，转字符串后为查询字符串</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chunk<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        将查询字符串解析为对象</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> querystring<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>chunk<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'登陆成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//路由传参</span>
<span class="token comment">//路由：查看包的详情</span>
<span class="token comment">//get   /package</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/package/:pname'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">//获取路由传参的数据</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'这是包的使用详情'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/shopping/:lid&amp;:count&amp;:uid'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">//获取路由传参的数据</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    商品的编号：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>lid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;br&gt;
    购买的数量：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;br&gt;
    用户的编号：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>uid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>以上响应在一个路由中只能调用一次</p> <p>练习：编写03_express.js,引入express，创建web服务器并设置端口为8080；添加路由（get/search），响应文件search.html</p> <p><code>&lt;h2&gt;用户搜索&lt;/h2&gt;</code></p> <p>练习：根据表单的请求添加路由（get/mysearch),响应’搜索成功‘</p> <p>练习：添加路由（get /login），响应文件login.html</p> <p>用户输入用户名和密码，点击提交；添加对应的路由（post  /mylogin),响应’登录成功‘</p> <table><thead><tr><th>传递方式</th> <th>格式</th> <th>路由获取</th></tr></thead> <tbody><tr><td>get传递</td> <td>查询字符串  <a href="http://127.0.0.1:8080/mysearch" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080/mysearch<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>?<strong>kw=笔记本&amp;id=2</strong></td> <td>req.query格式为对象</td></tr> <tr><td>post传递</td> <td>采用流的方式传递，不可见</td> <td>通过事件的方式获取   req.on（’data‘，（chunk）=&gt;{chunk 获取的数据，格式为buffer，转字符串后为查询字符串，需要借助查询字符串模块解析为对象}）</td></tr> <tr><td>路由传参</td> <td><a href="http://127.0.0.xn--18080-oi33a/package/express" target="_blank" rel="noopener noreferrer">http://127.0.0.1：8080/package/express<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>app.get('/package/:pname',(req,res)=&gt;{ req.params  获取路由传参的数据，格式为对象})</td></tr></tbody></table> <p>post传递：  没有大小限制，用于上传附件、视频.....</p> <p>对比get和post传递数据的区别</p> <p>​ get传递的数据格式为查询字符串，URL中可见；post传递的方式用流的方式，URL中不可见；post传递更加安全，通常注册、登录会使用；get传递的速度更快，通常搜索的时候使用</p> <p>​ get传递的数据有大小限制，根据不同的浏览器大小不同，范围2~8k之间，post没有限制</p> <p>练习：创建添加到购物车的路由（get  / shopping),传递商品的编号lid、购买的数量count、用户的编号uid，最后响应以下内容</p> <p>商品的编号：XX</p> <p>购买的数量：XX</p> <p>用户的编号：XX</p> <p>/shopping/30&amp;1&amp;5</p> <p>课后任务</p> <p>(1)复习今天内容，整理思维导图</p> <p>(2)练习：创建WEB服务器，设置端口，添加路由(get  /reg)，响应注册的文件reg.html，点击提交向服务器发送请求(post  /myreg)，创建路由接收请求，并获取传递的数据，响应“注册成功”</p> <p>(3)预习nodeyojs第5天  中间件、正则表达式</p> <p>![img](file:///C:\Users\ASUS\AppData\Local\Temp\ksohtml7692\wps1.jpg)</p> <h2 id="day14"><a href="#day14" class="header-anchor">#</a> day14</h2> <p>商品模块 /product</p> <p>列表、删除、修改</p> <p>/product/list  /product/delete  /product/update</p> <p>用户模块 /user</p> <p>列表、删除、修改</p> <p>/user/list  /user/delete  /user/update</p> <h3 id="_1-路由器"><a href="#_1-路由器" class="header-anchor">#</a> 1.路由器</h3> <p>用来管理路由，通常将一个模块下的路由放到一个路由器下，例如用户模块下额路由放入的路由放入到用户路由器</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//引入express</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建路由器对象</span>
<span class="token keyword">const</span> r <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//添加路由(get  /list)响应’用户列表‘</span>
r<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/list'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'用户列表'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//导出路由器对象</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> r<span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 在WEB服务器下引入并挂载</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span>userRooter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-中间件"><a href="#_2-中间件" class="header-anchor">#</a> 2.中间件</h3> <p>用于拦截对路由的请求，也可以做出响应，允许往后继续执行（下一个中间件或者路由）；本质上是一个函数，一旦拦截到会自动调用这个函数。</p> <p><img src="C:%5CUsers%5CASUS%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210525114205835.png" alt="image-20210525114205835"></p> <p>分为五大类：应用级中间件、路由级中间件、内置中间件、第三方中间件、错误处理中间件</p> <h4 id="_1-应用级中间件"><a href="#_1-应用级中间件" class="header-anchor">#</a> （1）应用级中间件</h4> <p>也称为自定义中间件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//添加中间件，拦截对/list的请求,一旦拦截调用fn</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'拦截了对/list的请求'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//    获取get显示传递的数据</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//    检测是否为管理员</span>
<span class="token comment">//    如果用户名不是root，响应请提供管理员账户</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>uname <span class="token operator">!==</span> <span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'请提供管理员账户'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token comment">//    否则是管理员root，往后继续执行，可能是下一个中间件或者是路由</span>
    <span class="token comment">//    next是一个函数形式,回调函数</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/list'</span><span class="token punctuation">,</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>app.use(要拦截的URL，回调函数)</p> <p>例如：app.use('/list',()=&gt;{})</p> <p>function fn(req,res,next){</p> <p>next()//往后继续执行，可能是下一个中间件或者是路由</p> <p>}</p> <p>中间件函数可以被复用</p> <p>练习：创建添加到购物车的路由（get  /shopping),传递商品的价格price，加中间件拦截该路由，对价格大8折，左后在路由中响应</p> <p>’商品的最终价格：XXX‘</p> <p>？price = XXX</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//添加中间件，拦截对/shopping的请求</span>
<span class="token keyword">function</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//     获取请求的数据</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//    打折</span>
    req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>price <span class="token operator">*=</span> <span class="token number">0.8</span><span class="token punctuation">;</span>
<span class="token comment">//    往后继续执行</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/shopping'</span><span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//添加到购物车路由（get   /shopping)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/shopping'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">//获取传递的数据</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">商品的最终价格为: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>price<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_2-路由级中间件"><a href="#_2-路由级中间件" class="header-anchor">#</a> （2）路由级中间件</h4> <p>路由器的使用</p> <p>app.use(要拦截的URL，路由器)</p> <h4 id="_3-内置中间件"><a href="#_3-内置中间件" class="header-anchor">#</a> （3）内置中间件</h4> <p>托管静态资源（html，css，js，图像...）</p> <p>如果浏览器端要请求静态资源，不需要通过路由响应文件，而是自动去寻找文件。</p> <p>app.use(<strong>express.static('要托管的目录')</strong>)；</p> <p>练习：再次托管静态资源到files目录，如果public和files目录出现相同的文件名称，哪一个起作用  ：第一个起作用</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//托管静态资源：如果浏览器端要请求静态资源，自动到public目录寻找</span>
<span class="token comment">//内置中间件</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'./public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ./public:要托管的位置</span>
    <span class="token comment">/*
     练习：再次托管静态资源到files目录，
     如果public和files目录出现相同的文件名称，哪一个起作用
     */</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'./files'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>练习：编写文件05_three.js,创建web服务器，设置端口8080；托管静态资源到public目录，新建文件login.html，点击提交向服务器发送（post  /login),创建路由，获取传递的数据，响应’登陆成功‘</p> <p><img src="C:%5CUsers%5CASUS%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210525170649298.png" alt="image-20210525170649298"></p> <h4 id="_4-第三方中间件"><a href="#_4-第三方中间件" class="header-anchor">#</a> （4）第三方中间件</h4> <p>第三方中间件属于第三方模块，需先去下载安装</p> <p>npm install body-parser</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1.引入body-parser中间件</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//托管静态资源</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'./public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//2.使用body—parser中间件，将post请求的数据解析为对象</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    extended<span class="token operator">:</span><span class="token boolean">true</span>
    <span class="token comment">//是否使用第三方的查询字符串模块qs</span>
    <span class="token comment">// 如果不使用（false）就会使用核心模块下的querystring</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/login.html'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
 <span class="token comment">// 3.在路由中获取post传递的数据   req.body</span>
 <span class="token comment">//   前提使用了中间件</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-mysql模块"><a href="#_3-mysql模块" class="header-anchor">#</a> 3.mysql模块</h3> <p>属于第三方模块，Node.js下操作mysql数据库的模块</p> <p>下载安装</p> <p>npm install mysql</p> <p>连接</p> <p>mysql  -uroot</p> <p>mysql.exe  -h127.0.0.1  -p3306  -uroot  -p</p> <p>mysql  -uroot&lt;拖拽脚本     回车</p> <p>insert  into emp  values（.....）</p> <p>delete  from  emp  where  eid = 1；</p> <p>update  emp  set  sex = 1，...  where  eid = 2；</p> <p>select  *  from  emp  where...</p> <h2 id="day15"><a href="#day15" class="header-anchor">#</a> day15</h2> <h3 id="_1-mysql模块"><a href="#_1-mysql模块" class="header-anchor">#</a> 1.mysql模块</h3> <p>（1）创建普通连接</p> <p>createConnection（）</p> <p>（2）执行SQL命令</p> <p>query（SQL命令，回调函数）</p> <p>属于异步操作，通过回调函数获取结果</p> <p>err      可能产生的错误结果</p> <p>result  成功的结果</p> <p>（3）创建连接池</p> <p>createPool（）</p> <p>连接池</p> <p>取一个连接去连接，连接后归还</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//引入连接池对象</span>
<span class="token keyword">const</span> pool <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../pool.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//创建连接池对象</span>
<span class="token keyword">const</span> pool <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createPool</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    host<span class="token operator">:</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
    port<span class="token operator">:</span><span class="token string">'3306'</span><span class="token punctuation">,</span>
    user<span class="token operator">:</span><span class="token string">'root'</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
    database<span class="token operator">:</span><span class="token string">'tedu'</span><span class="token punctuation">,</span>
    connectionLimit<span class="token operator">:</span><span class="token number">15</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//导出连接池对象</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> pool<span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//获取员工资源的接口</span>
<span class="token comment">//通过路由来完成的接口 （get  /v1/emps）</span>
<span class="token comment">// http://127.0.0.1:8080/v1/emps/1</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/v1/emps/:eid'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">//获取路由传参的数据</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//执行SQL命令，查询编号对应的员工</span>
pool<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'select * from emp where eid = ?'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>obj<span class="token punctuation">.</span>eid<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>result</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>  <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        code<span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
        msg<span class="token operator">:</span><span class="token string">'获取成功'</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span>result
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>（4）占位符（？）</p> <p>SQL注入：在让用户提供的值中出现了对数据库有攻击的命令</p> <p>解决方法：对所有用户提供的值进行过滤</p> <p>所有SQL命令中需要拼接的用户的值，先进行过滤，然后再去替换占位符</p> <p>query('delete from emp where eid = ?',[18],(err,result)=&gt;{   })</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">'小离 &quot; or &quot; 1'</span><span class="token punctuation">;</span>
<span class="token comment">//'select * from emp where ename =&quot;' + '小离 &quot; or &quot; 1' + '&quot;'  //所有数据都暴露出来</span>
<span class="token comment">//方法一：let str = '小离 \' or \' 1';</span>
<span class="token comment">//方法二：占位符（？），mysql模块提供的，用于过滤用户提供的数据</span>
pool<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'select * from emp where ename=?'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>str<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>result</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>  <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>下载软件：apipost  用于接口测试</p> <p><a href="https://www.apipost.cn/download.html" target="_blank" rel="noopener noreferrer">https://www.apipost.cn/download.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_2-正则表达式"><a href="#_2-正则表达式" class="header-anchor">#</a> 2.正则表达式</h3> <h4 id="_1-最简单规则就是要找到的关键词正文"><a href="#_1-最简单规则就是要找到的关键词正文" class="header-anchor">#</a> （1）最简单规则就是要找到的关键词正文</h4> <h4 id="_2-字符集-规定一位字符上多种备选字的列表-当某一位字符上有多种备选字时-用字符集"><a href="#_2-字符集-规定一位字符上多种备选字的列表-当某一位字符上有多种备选字时-用字符集" class="header-anchor">#</a> （2）字符集：规定一位字符上多种备选字的列表，当某一位字符上有多种备选字时，用字符集  []</h4> <h4 id="_3-中部分备选字时连续的-x-x"><a href="#_3-中部分备选字时连续的-x-x" class="header-anchor">#</a> （3）[]中部分备选字时连续的：[x-x]</h4> <p>要匹配一位汉字：[\u4e00-\u9fa5]      //包含所有汉字</p> <h4 id="_4-预定义字符集"><a href="#_4-预定义字符集" class="header-anchor">#</a> (4)预定义字符集</h4> <p>\d :[0-9]</p> <p>\w:[0-9A-Za-z]</p> <p>\s:空格、制表符tab等空白</p> <p>.  ：任意字符</p> <h4 id="_5-数量词"><a href="#_5-数量词" class="header-anchor">#</a> （5）数量词</h4> <p>1.有明确数量边界的数量词
字符集{n}    表示字符集必须重复n次，不能多也不能少
字符集{n,m}  表示字符集至少重复n次，最多重复m次，
比如: \d{4,6} 表示4到6位数字
字符集{n,}  表示字符集匹配的内容至少重复n次，多了不限，比如：\d{6,} 表示6位以上数字</p> <p>2.没有明确数量边界的数量词</p> <p>*可有可无，多了不限
?  可有可无，最多一次</p> <p>+至少一次，多了不限</p> <p>eg：([我卧]|wo)\s*([草艹槽]|cao)</p> <p>( \ +86|0086) ——+是正则有功能的特殊符号，可是这里不希望+当做特殊功能使用，只当做普通字符匹配，所以用+阻止正则解析+为数量词。</p> <p>至少一个空字符 : \s+
之前所有，整体可有可无，最多一次： ()?</p> <p>eg：定义完整手机号规则</p> <p>( \ +86|0086)\s+)?1[3-9]\d{9}</p> <h4 id="_6-选择和分组"><a href="#_6-选择和分组" class="header-anchor">#</a> （6）选择和分组</h4> <p><strong>选择</strong>，是指在多个子规则中选其一匹配</p> <p>今后，只要在多个子规则中选其一匹配时，就用选择
如何:     子规则1   |   子规则2<br>
读作:  满足规则1 或  满足规则2
“|”选择符只分左右，不考虑单个字符</p> <p>eg：草|cao</p> <p><strong>分组</strong>，将多个子规则视为一组，再和分组外的规则匹配
只要希望将多个子规则视为一个整体，再和其它规则匹配时，就用分组
如何： 其它规则 (多个子规则)</p> <p>eg：我（草|cao）</p> <h4 id="_7-指定匹配位置"><a href="#_7-指定匹配位置" class="header-anchor">#</a> （7）指定匹配位置</h4> <p>^字符串的开头位置</p> <p>$字符串的结尾位置</p> <p>\b 表示单词边界，可匹配：空格，标点符号，字符串开头和结尾等可将一个单词与其它单词分割开的符号。</p> <p>问题: 只写\b什么也匹配不到
原因: 其实\b是”零宽”，只匹配位置，不匹配字符
所以: 下边这句话其实有8个单词边界</p> <p>you can you up</p> <h4 id="_8-api"><a href="#_8-api" class="header-anchor">#</a> (8)API</h4> <h5 id="_1-查找一个固定不变的敏感词在字符串中出现的位置"><a href="#_1-查找一个固定不变的敏感词在字符串中出现的位置" class="header-anchor">#</a> 1.查找一个固定不变的敏感词在字符串中出现的位置</h5> <p>a.回顾：var i = str.indexOf（&quot;敏感词&quot;，fromi）
位置&lt;-的&lt;-'敏感词'</p> <p>b.在字符串str中，从fromi位置开始，查找下一个’敏感词‘出现的位置。</p> <p>c.简写：第二个参数fromi可省略，如果省略fromi，则默认从0位置（开头）查找第一个’敏感词‘出现的位置</p> <p>d.返回值：如果找到敏感词，这返回敏感词第一个字的下标位置i。如果没找到敏感词，则返回-1.</p> <p>eg：检查是否包含敏感词”我草“</p> <div class="language-html extra-class"><pre class="language-html"><code>var i = str.indexOf('我草');
if(i != -1){
document.write(`&lt;h1 style='color:red')管理员：发现敏感词<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h</span><span class="token punctuation">&gt;</span></span>`}else{
document.write(`<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span>green</span><span class="token punctuation">'</span></span></span><span class="token punctuation">&gt;</span></span>
    然哥:${msg}<span class="token comment">&lt;!--显示“然哥说：XXXX”--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>`)
}
</code></pre></div><h5 id="_2-用正则表达式模糊查找多种正则表达式的位置"><a href="#_2-用正则表达式模糊查找多种正则表达式的位置" class="header-anchor">#</a> 2.用正则表达式模糊查找多种正则表达式的位置</h5> <p>a.var i = str.search（/正则/);</p> <p>b.在字符串str中，从fromi位置开始，查找下一个’敏感词‘出现的位置。</p> <p>c.简写：第二个参数fromi可省略，如果省略fromi，则默认从0位置（开头）查找第一个’敏感词‘出现的位置</p> <p>d.返回值：如果找到敏感词，这返回敏感词第一个字的下标位置i。如果没找到敏感词，则返回-1.</p> <p>问题：只能返回敏感词的位置，不能返回敏感词的内容</p> <div class="language-html extra-class"><pre class="language-html"><code>var i = str.search(/([我卧]|wo)\s*([草艹槽]|cao)/);
if(i != -1){
document.write(`&lt;h1 style='color:red')管理员：发现敏感词<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h</span><span class="token punctuation">&gt;</span></span>`}else{
document.write(`<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span>green</span><span class="token punctuation">'</span></span></span><span class="token punctuation">&gt;</span></span>
    然哥:${msg}<span class="token comment">&lt;!--显示“然哥说：XXXX”--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>`)
}
</code></pre></div><h5 id="_3-获取敏感词的内容"><a href="#_3-获取敏感词的内容" class="header-anchor">#</a> 3.获取敏感词的内容</h5> <p>a.var arr = str.match(/正则/i)</p> <p>​       匹配</p> <p>b.用正则去匹配str中第一个符合要求的敏感词</p> <p>c.返回值：</p> <p>​ 1）如果找敏感词，就同时返回一个数组！</p> <ul><li><p>数组中包括：这个敏感词的内容和敏感词第一个字的位置</p></li> <li><p>数组结构：（2个房间（元素））</p> <p>[</p> <p>​ '0':'敏感词的内容，</p> <p>​ ’index‘：敏感词第一个字的位置</p> <p>]</p> <p>js中有两种数组：索引数组和关联数组</p> <p>索引数组：所有元素的下标都是数字的数组  var arr=[10,20,30,40]</p> <p>关联数组：所有元素的下标都是自定义的字符串名称的数组</p> <p>var ym=[]</p> <p>ym[&quot;math&quot;]=98</p> <p>ym[&quot;eng&quot;]=91</p> <p>结果：[</p> <p>&quot;math&quot;:98,</p> <p>&quot;eng&quot;:91]</p></li> <li><p>这个敏感词的内容和敏感词第一个字的位置，如果找不到敏感词，返回null</p> <p>d.解决match默认只能查找第一个敏感词，无法查找字符串中所有敏感词：在match中正则第二个/后面加**/g** ，意味global全部，但是只能返回敏感词的内容，无法返回位置</p> <p>var arr = str.match(/正则/<strong>g</strong>)</p> <p>总结：1.想获取第一个敏感词的内容和位置：就用match不加g</p> <p>2.获取所有敏感词的内容，不关心位置，就用match加g</p></li></ul> <p>​ 2）</p> <p>正则表达式完整视频
<a href="https://pan.baidu.com/s/1IgYS8oGBrRgZQropPUTnoA" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1IgYS8oGBrRgZQropPUTnoA<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 提取码：nbx3
正则相关函数的用法总结
<a href="https://pan.baidu.com/s/1Rvqr-5UI7NxoxArdgxyRhg" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1Rvqr-5UI7NxoxArdgxyRhg<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 提取码：08yj</p> <h3 id="_3-restful接口-api"><a href="#_3-restful接口-api" class="header-anchor">#</a> 3.RESTful接口（API）</h3> <p>接口：后端为前端提供的动态资源（数据、后端验证....）属于后端软件</p> <p>RESTful是一种接口设计风格（规范）</p> <p>动态资源就是一个URL形式</p> <h4 id="_1-url"><a href="#_1-url" class="header-anchor">#</a> （1）URL</h4> <p>所有的资源都需要版本号，复数形式</p> <p>例如：请求员工资源</p> <p><a href="http://127.0.0.1:8080/" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><strong>v1</strong>/emp<strong>s</strong>               多个资源</p> <p>​                                  版本号/资源名称</p> <p>版本2的用户资源：</p> <p><a href="http://127.0.0.1:8080/v2/user" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080/v2/user<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><strong>s</strong>                多个资源</p> <p><a href="http://127.0.0.1:8080/v2/users/" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080/v2/users/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><code>&lt;u&gt;</code>3             单个资源</p> <p>​                                                      编号</p> <p><a href="http://127.0.0.1:8080/v2/users/checkuname" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080/v2/users/checkuname<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>   检测用户名</p> <p>​                                                     对资源的特殊操作</p> <p>app.get('/v2/users',()=&gt;{})    //在路由中用到</p> <h4 id="_2-请求方法"><a href="#_2-请求方法" class="header-anchor">#</a> （2）请求方法</h4> <p>对资源的操作方式：增删改查      浏览器只能发送get和post</p> <p>get          获取资源</p> <p>delete    删除资源</p> <p>post       新建资源</p> <p>put         修改资源</p> <p>练习：添加路由，删除某一个用户用户资源</p> <p>app.delete('/v2/users/:uid',(req,res)=&gt;{    })</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/v1/emps/:eid'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
<span class="token comment">//    获取路由传参的数据</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//    执行SQL命令</span>
    pool<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'delete from emp where eid = ?'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>obj<span class="token punctuation">.</span>eid<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>result</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>  <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//    返回的结果是对象</span>
<span class="token comment">// 如果对象下的affectRows属性值为0说明删除失败，否则删除成功</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>affectedRows <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>code<span class="token operator">:</span><span class="token number">201</span><span class="token punctuation">,</span>msg<span class="token operator">:</span><span class="token string">'删除失败'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>code<span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>msg<span class="token operator">:</span><span class="token string">'删除成功'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_3-过滤数据"><a href="#_3-过滤数据" class="header-anchor">#</a> （3）过滤数据</h4> <p>查询的结果有太多的记录，需要过滤想要的数据</p> <p>eg：分页</p> <p><a href="http://127.0.0.1:8080/v2/users" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080/v2/users<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>?<strong>pno=1&amp;count=10</strong></p> <p>​                                                         页码     每页数据量</p> <p>eg：获取商品的价格区间</p> <p><a href="http://127.0.0.1:8080/v2/products" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080/v2/products<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>?<strong>price1=10000&amp;price2=20000</strong></p> <h4 id="_4-返回结果"><a href="#_4-返回结果" class="header-anchor">#</a> （4）返回结果</h4> <p>包含状态码、消息、数据（不一定都有）</p> <p>登陆的接口</p> <p>{   //json对象</p> <p>​ &quot;code&quot;：200，</p> <p>​ &quot;msg&quot;：&quot;登录成功&quot;</p> <p>}</p> <p>获取员工数据</p> <p>{</p> <p>​ “code”：200，</p> <p>​ “msg”：“获取成功”，</p> <p>​ “data”：[......]  //获取的员工数据</p> <p>}</p> <p>课后任务</p> <p>完成删除员工的接口</p> <p>​ 请求方法 delete    /v1/emps/编号</p> <p>​ 响应结果 {code：200，msg：’删除成功‘}</p> <h2 id="day16"><a href="#day16" class="header-anchor">#</a> day16</h2> <p>练习：在app.js下创建服务器并设置端口</p> <p>练习：创建路由器目录router，目录下包含由用户路由器user.js，创建路由器对象，添加用户注册的路由</p> <p>（post  /reg）,响应{code:200,msg:'注册成功'}</p> <p>练习：在web服务器app.js中引入用户路由器(./router/user.js)，并挂载，添加前缀/v1/users</p> <p>/reg</p> <p>/v1/users/reg</p> <p>header:get  传递的数据</p> <p>​   body ：</p> <p>练习:在user.js中编写用户登录的路由(post   /login),获取post请求的数据,验证各项是否为空,执行SQL命令,如果查询到了用户名和密码同时匹配的数据就是登陆成功,否则登陆失败</p> <p>练习:编写按照编号查找员工(get  /编号),获取传递的编号,执行SQL命令,查询编号对应的用户,如果每页查询到{code:201,msg:&quot;该用户不存在&quot;},否则查询到{code:200,msg:'查询成功',data:[..]}</p> <p>练习:编写按照编号删除员工(delete  /编号),获取传递的编号,执行SQL命令,删除编号对应的用户,如果删除失败{code:201,msg:'删除失败'},否则删除成功{code:200,msg:'删除成功'}</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>v1<span class="token operator">/</span>users<span class="token operator">/</span><span class="token operator">:</span>eid
</code></pre></div><div class="language-test extra-class"><pre class="language-text"><code>![image-20210527173657131](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20210527173657131.png)

http://127.0.0.1:8080/v1/users/3


git下载地址

https://pc.qq.com/detail/13/detail_22693.html

 

码云注册账号

https://gitee.com/

GitHub注册账号

https://github.com
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Note/CSS.html" class="prev">
        css
      </a></span> <span class="next"><a href="/Note/数据库.html">
        数据库5.8
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a872a4b8.js" defer></script><script src="/assets/js/2.15df7a88.js" defer></script><script src="/assets/js/21.fabc5358.js" defer></script>
  </body>
</html>
